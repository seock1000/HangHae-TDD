# 성능테스트 실행 계획 보고서 

---
1. 선착순 쿠폰 발급
   1. 선정 테스트 및 목적
      - stress test : 발급 수량보다 훨씬 많은 요청을 보내 시스템의 최대 처리 능력 파악
        - vu 100(warmup) -> vu 200 ~ 10000 : 100씩 점진적 증가 
      - peak test : 짧은 시간에 높은 트래픽을 순간적으로 집중시켜 시스템의 피크 처리 능력을 검증
        - 예상 DAU : 10000
        - 예상 피크 시간대 집중률 : 10
        - 예상 인당 1일 평균 요청 수 : 50
        - 1일 평균 rps : 10000 * 50 / 86400 = 약 5.8 rps
        - 1일 최대 rps : 10000 * 50 * 10 / 86400 = 약 58 rps
        - 목표 rps : 150 rps
        - Latency : 500ms 
        - vu = 150×0.5 = 75
        
  2. 테스트 시나리오
     - stress test
      
        | 항목                     | 내용                                                                                             |
        | ---------------------- |------------------------------------------------------------------------------------------------|
        | **시나리오명**              | 선착순 쿠폰 발급 스트레스 테스트                                                                             |
        | **목표**                 | 시스템이 처리 가능한 최대 요청 수(RPS)를 측정하고, 실패율 증가 또는 성능 저하가 발생하는 임계점을 파악한다                                |
        | **전제 조건**              | <ul><li>발급 대상 쿠폰은 수량 제한 (예: 100개)</li><li>중복 발급 방지</li><li>Kafka 및 Consumer가 정상 작동 중</li></ul> |
        | **요청 데이터 예시**          | <pre>{ "userId": "1L", "couponId": "1L" }</pre>                                                |
        | **테스트 방식**             | 서버 다운 시까지 점진적으로 VU 및 요청 수 증가 (Stage 기반)                                                        |
        | **요청 지연 기준 (Latency)** | p50 < 500ms, p95 < 1000ms, p99 < 3000ms                                                        |
        | **성공 기준**              | <ul><li>100명만 발급 성공</li><li>중복 발급 없음</li><li>오류율 5% 이하</li><li>Kafka backlog 없음</li></ul>      |
        | **실패 기준**              | <ul><li>응답 시간 p95 > 500ms</li><li>에러율 > 10%</li><li>시스템 다운, DB lock, Kafka 누락 등</li></ul>      |

     - peak test

       | 항목             | 내용                                                                                 |
       | -------------- |------------------------------------------------------------------------------------|
       | **시나리오명**      | 선착순 쿠폰 발급 피크 테스트                                                                   |
       | **목표**         | 짧은 시간에 순간적으로 몰리는 고부하 트래픽을 시스템이 안정적으로 처리할 수 있는지 확인한다                                |
       | **전제 조건**      | <ul><li>쿠폰은 선착순 100개 한정</li><li>중복 발급 방지</li><li>Kafka와 Consumer 정상 작동 중</li></ul> |
       | **입력 예시**      | <pre>{ "userId": "1L", "couponId": "1L" }</pre>                                    |
       | **테스트 핵심 조건**  | <ul><li>동시에 수천 명이 요청</li><li>단 몇 초 내에 부하 집중</li></ul>                              |
       | **테스트 목표 RPS** | 순간 피크 1,000 RPS 이상                                                                 |
       | **Latency 목표** | p50 < 500ms, p95 < 1000ms, p99 < 3000ms                                            |
       | **성공 기준**      | <ul><li>정확히 100명만 발급 성공</li><li>3000ms 이내 응답</li><li>에러율 < 5%</li></ul>    |
       | **실패 기준**      | <ul><li>Kafka backlog 증가</li><li>시스템 hang 또는 DB lock</li><li>오류율 > 10%</li></ul>   |
