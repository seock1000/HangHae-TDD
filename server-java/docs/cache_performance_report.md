### Cache 성능 분석 보고서
- **목적**: Cache 성능 분석을 통해 시스템의 효율성을 평가하고 개선 방안을 제시합니다.
- **대상**
  - 빈번한 조회가 예상되는 기능 : 인기상품 목록 조회, 상품 목록 조회

---
#### 1. Cache 적용 이전
- 인기상품 목록 조회
    - 인기상품 데이터 : 10_000건
    - 상품 데이터 : 10_000건
    - 인기상품 목록 조회 API 호출 시, 인기상품 데이터 10_000건 주문량으로 정렬 후 상위 5건을 DB에서 조회 후 상품 정보를 조회하여 응답
    - k6 테스트 시나리오 : 
      - 10명의 사용자가 100회씩 API 호출
      - 총 1000회 API 호출
  ```
     █ TOTAL RESULTS 

    checks_total.......................: 1000    74.686888/s
    checks_succeeded...................: 100.00% 1000 out of 1000
    checks_failed......................: 0.00%   0 out of 1000

    ✓ status is 200

    CUSTOM
    successful_requests.....................................................: 1000   74.686888/s

    HTTP
    http_req_duration.......................................................: avg=132.9ms  min=28.19ms med=101.92ms max=1.55s p(90)=156.47ms p(95)=181.97ms
      { expected_response:true }............................................: avg=132.9ms  min=28.19ms med=101.92ms max=1.55s p(90)=156.47ms p(95)=181.97ms
    http_req_failed.........................................................: 0.00%  0 out of 1000
    http_reqs...............................................................: 1000   74.686888/s

    EXECUTION
    iteration_duration......................................................: avg=133.09ms min=28.3ms  med=102.05ms max=1.55s p(90)=156.64ms p(95)=182.12ms
    iterations..............................................................: 1000   74.686888/s
    vus.....................................................................: 10     min=10        max=10
    vus_max.................................................................: 10     min=10        max=10

    NETWORK
    data_received...........................................................: 664 kB 50 kB/s
    data_sent...............................................................: 102 kB 7.6 kB/s
  ```
- 상품 목록 조회
  - 상품 데이터 : 10_000건
  - 상품 조회 API 호출 시, DB에서 상품을 조회 및 페이징 처리 하여 응답
  - k6 테스트 시나리오 :
      - 10명의 사용자가 1~10페이지를 각각 10회씩 총 100회 씩 API 호출
      - 총 1000회 API 호출
  ```
    █ TOTAL RESULTS 

    checks_total.......................: 1000    113.59765/s
    checks_succeeded...................: 100.00% 1000 out of 1000
    checks_failed......................: 0.00%   0 out of 1000

    ✓ status is 200

    CUSTOM
    successful_requests.....................................................: 1000   113.59765/s

    HTTP
    http_req_duration.......................................................: avg=87.45ms min=13.66ms med=55.7ms  max=1.9s p(90)=103.31ms p(95)=186.36ms
      { expected_response:true }............................................: avg=87.45ms min=13.66ms med=55.7ms  max=1.9s p(90)=103.31ms p(95)=186.36ms
    http_req_failed.........................................................: 0.00%  0 out of 1000
    http_reqs...............................................................: 1000   113.59765/s

    EXECUTION
    iteration_duration......................................................: avg=87.74ms min=13.81ms med=55.91ms max=1.9s p(90)=103.53ms p(95)=186.55ms
    iterations..............................................................: 1000   113.59765/s
    vus.....................................................................: 10     min=10        max=10
    vus_max.................................................................: 10     min=10        max=10

    NETWORK
    data_received...........................................................: 1.8 MB 206 kB/s
    data_sent...............................................................: 106 kB 12 kB/s
  ```
---
#### 2. 기능별 Caching 전략
- 인기상품 목록 조회
  - 인기상품 데이터 : Local Cache, Read Through
    - 1일 1회 갱신되는 데이터로 변경이 거의 없으므로 서버간 공유가 불필요
    - 조회가 빈번
    - TTL : 25hour
    - 23:40 인기 상품 데이터 갱신 이후 00:00에 cache put
  - 상품 데이터 : Global Cache, Look Aside
    - 상품 데이터는 재고 관련 변경이 자주 일어나고 서버간 공유가 필요하여 Global Cache를 사용
    - 현재 서비스에서는 주문 시 캐시 만료 필요
    - TTL : 30sec
    - 변경이 잦을 수 있으므로 TTL을 짧게 설정
    
- 상품목록 조회
  - 상품 데이터 : Global Cache, Look Aside
    - 상품 데이터는 재고 관련 변경이 자주 일어나고 서버간 공유가 필요하여 Global Cache를 사용
    - 현재 서비스에서는 주문 시 캐시 만료 필요
    - TTL : 30sec
    - 변경이 잦을 수 있으므로 TTL을 짧게 설정
---
#### 3. Cache 적용 이후
- 인기 상품 조회
  - 동일 조건 하 테스트
  ```
   █ TOTAL RESULTS 

    checks_total.......................: 1000    536.434353/s
    checks_succeeded...................: 100.00% 1000 out of 1000
    checks_failed......................: 0.00%   0 out of 1000

    ✓ status is 200

    CUSTOM
    successful_requests.....................................................: 1000   536.434353/s

    HTTP
    http_req_duration.......................................................: avg=18.26ms min=5.22ms med=17.81ms max=35.95ms p(90)=23.62ms p(95)=25.96ms
      { expected_response:true }............................................: avg=18.26ms min=5.22ms med=17.81ms max=35.95ms p(90)=23.62ms p(95)=25.96ms
    http_req_failed.........................................................: 0.00%  0 out of 1000
    http_reqs...............................................................: 1000   536.434353/s

    EXECUTION
    iteration_duration......................................................: avg=18.45ms min=5.36ms med=17.97ms max=36.15ms p(90)=23.8ms  p(95)=26.17ms
    iterations..............................................................: 1000   536.434353/s
    vus.....................................................................: 10     min=10        max=10
    vus_max.................................................................: 10     min=10        max=10

    NETWORK
    data_received...........................................................: 3.6 MB 1.9 MB/s
    data_sent...............................................................: 105 kB 56 kB/s
  ```
- 상품 목록 조회
  - 동일 조건 하 테스트
  ```
  █ TOTAL RESULTS 

    checks_total.......................: 1000    547.725515/s
    checks_succeeded...................: 100.00% 1000 out of 1000
    checks_failed......................: 0.00%   0 out of 1000

    ✓ status is 200

    CUSTOM
    successful_requests.....................................................: 1000   547.725515/s

    HTTP
    http_req_duration.......................................................: avg=17.9ms  min=6.24ms med=17.87ms max=34ms    p(90)=22ms    p(95)=23.9ms 
      { expected_response:true }............................................: avg=17.9ms  min=6.24ms med=17.87ms max=34ms    p(90)=22ms    p(95)=23.9ms 
    http_req_failed.........................................................: 0.00%  0 out of 1000
    http_reqs...............................................................: 1000   547.725515/s

    EXECUTION
    iteration_duration......................................................: avg=18.07ms min=6.36ms med=18.04ms max=34.19ms p(90)=22.19ms p(95)=24.15ms
    iterations..............................................................: 1000   547.725515/s
    vus.....................................................................: 10     min=10        max=10
    vus_max.................................................................: 10     min=10        max=10

    NETWORK
    data_received...........................................................: 3.6 MB 1.9 MB/s
    data_sent...............................................................: 105 kB 58 kB/s

  ```
  
---
#### 4. 성능 비교

#### 🔍 인기상품 목록 조회

| 항목                | 캐시 적용 전 | 캐시 적용 후 | 감소율 (%)        |
|---------------------|---------------|---------------|--------------------|
| 평균 응답 시간      | 132.9ms       | 18.26ms       | **86.26% ↓**       |
| 최소 응답 시간      | 28.19ms       | 5.22ms        | **81.49% ↓**       |
| 최대 응답 시간      | 1.55s         | 35.95ms       | **97.68% ↓**       |
| p(90) 응답 시간     | 156.47ms      | 23.62ms       | **84.9% ↓**        |
| p(95) 응답 시간     | 181.97ms      | 25.96ms       | **85.73% ↓**       |
| 초당 처리량 (RPS)   | 74.69 req/s   | 536.43 req/s  | **618.26% ↑**      |

---

#### 🔍 상품 목록 조회

| 항목                | 캐시 적용 전 | 캐시 적용 후 | 감소율 (%)        |
|---------------------|---------------|---------------|--------------------|
| 평균 응답 시간      | 87.45ms       | 17.9ms        | **79.54% ↓**       |
| 최소 응답 시간      | 13.66ms       | 6.24ms        | **54.32% ↓**       |
| 최대 응답 시간      | 1.9s          | 34ms          | **98.21% ↓**       |
| p(90) 응답 시간     | 103.31ms      | 22ms          | **78.7% ↓**        |
| p(95) 응답 시간     | 186.36ms      | 23.9ms        | **87.17% ↓**       |
| 초당 처리량 (RPS)   | 113.60 req/s  | 547.73 req/s  | **382.12% ↑**      |